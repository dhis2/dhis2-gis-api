language: node_js
node_js:
- '8'
env:
  matrix:
  - CXX=g++-4.8
  global:
  - secure: YnTm0Kht1DY9Vafm9cSFkSMHhmb9dSCy2cyJyZtyhb5mYbPX5xbk51Qzq+vVqBUB8a4lvTqj1/JR/kaSPNZswl3GgIrLSu6JrWwXQau1H1rJPyit0W58agunvhFQDicylZaDEqEOcaxX7nvahAMdVcdph5yjkqbFhD9XYuHEKzAce5L428xEVMS4Z2Muta66Lp8wMgcLkDxL2ba0oV1thJDCEHoU8HIpzgdUKcF6xvdfO7qGDfHsVXki6FhH2ZCJiJeqn1XFvG+SBOq2ozPrC+8H4h7OSj97bZ3jPA1Wu2ZkiBeaKRSmeAdIMcaipSQpNZR5vuR/nVzdF3b2LLzVScb/XaFE2WgBSqm90hdzFtgpk7CB3Mrf2RKsjfxzaSuW6wV8TTm+z07M1Vhmp2bHHcD04xEQHD0wvH0V0fFO+jQKKlMa1x/2e9uDjoEeRtr/hhFEVKT/oxDdDi3J3M37+vgxriYiLP0I5Mgs/oJBw0MTvFjY1+6S2t1yBQwawmBQ7Q8ZIxjjvQYPjQzG/JgOVguwYRRCD7dIKiXb6lroyow5YTU+tMOhZVqMpiQru27VuGiQOqimHFCNSvtpcr4q5ez71lv7+RpXt4ek3I2ucuY6kLm9WFtv0dJWuPxQDRZRNK81smzreTAI+gbuJxuf+UVoqUFKzzsSb/7u1URpMts=
  - secure: XH7UpxFe12oyDUtwCzm2HR69lrhUg7a02uoJ7xxVNB6bgIahr2MDl+zQNxryXXbKhTU9RAH3DY70vdKXAvI4az/7qn/dc0cMwFWWHiifHiIELR/56dIdULAH26whS+719/08doLomi+cLVse3uK7V7fLkKllz3kVmxJY8lJX0S4qpGVu1jqrtX3tVXgIgsA/6PiUD45uryRqE0RnRuaGq2lZLZyBUgJVf5QwNA6++HY1eIYawRpgINOL9mI7FoFrsyHvu4FxF0gj66xSWv3owFPrxZ/OLdZPhIyY1koYlZnzmNBgX5JD8XMpmNvG3zh7MF7OD1Y9KkKhfqtspfSMdoT1HeHPSxmjosho6c+UcE3kKC7S8RXm4OKgJJsiB2TOIPEY6++OCgpX0Lht7CvbHfPBak/rqB3fwdBep/fN990hfuERBzhvFXEylB4nI/ZOrm8htfGcYMGhhLMBhrSDynALG9utdvMczTIWN2fuM9Le3SkH6xQKpUNwn3mJZequ9HKnT0k/F7+P3AiKYn0i6rVAqX2yPK5ljparAjKnLcb4xhZNyMYuCaHZCwJkmAAxDV6dc1NHrzZNis22b6ac2XB0W5zN3oAZtNj0dVFF+A2zt+8SLMqHCr/eNHVLWnc0qd43/UQ5NfGzWxOPZ3gyqWS4hYdVJpJHGrt1KRMl1HY=
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
    - pngquant
before_script:
- npm install --global @dhis2/deploy-build
- npm rebuild node-sass
script:
- npm run build
deploy:
- provider: script
  script: deploy-build
  skip_cleanup: true
  on:
    all_branches: true
- provider: script
  script: publish-build
  skip_cleanup: true
  on:
    tags: true
